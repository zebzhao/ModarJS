window.pyscript={modules:{}},pyscript.defer=function(t){setTimeout(t,1)},pyscript.range=function(t,e,r){void 0===e&&(e=t,t=0),r=r||1;for(var n=[],i=t;e>i;i+=r)n.push(i);return n},pyscript.noop=function(){},pyscript.extend=function(t,e){for(var r in e)e.hasOwnProperty(r)&&void 0!==e[r]&&(t[r]=e[r]);return t},pyscript.type=function(t){var e=Object.prototype.toString.call(t);return e.toLowerCase().substring(8,e.length-1)},pyscript.map=function(t,e){var r,n;switch(pyscript.type(e)){case"array":for(r=[],n=0;n<e.length;n++)r.push(t.call(null,e[n],n));break;default:r={};for(n in e)e.hasOwnProperty(n)&&(r[n]=t.call(null,e[n],n))}return r},pyscript.all=function(t,e){for(var r in e)if(e.hasOwnProperty(r)&&!t.call(null,e[r],r))return!1;return!0},pyscript.any=function(t,e){for(var r in e)if(e.hasOwnProperty(r)&&t.call(null,e[r],r))return!0;return!1},pyscript.partial=function(t){var e=[].slice.call(arguments).slice(1);return function(){var r=[].slice.call(arguments);return t.apply(this,e.concat(r))}},function(){function t(t){return-1!=t.indexOf("://")?t:pyscript.prefix+t}pyscript.mockDependencies=function(e){pyscript.assert(jasmine,"mockDependencies() must be called from Jasmine testing."),spyOn(pyscript,"_getURL").and.callFake(function(r){return e[r]?(console.log("%c"+r+" overridden by "+e[r],"color:DodgerBlue;"),t(e[r])):t(r)})},pyscript._getURL=t}(),pyscript["import"]=function(t,e,r){var n=document.createElement(t);return document.head.appendChild(n),n.onload=r,pyscript.extend(n,e),n},pyscript.initialize=function(t){var e=window._py_all_modules=window._py_all_modules||{},r=e[t];return r?r._initialize():void pyscript.assert("Module "+t+" is not defined!")},pyscript.module=function(t){var e=window._py_all_modules=window._py_all_modules||{},r=e[t];return r?r._instance:null},pyscript.defmodule=function(t){var e=pyscript.module(t);e||(e={__name__:t,__initialized__:!1},pyscript.modules[t]=e);var r=window._py_all_modules=window._py_all_modules||{},n=window._py_cached_files=window._py_cached_files||pyscript.dict();if(r[t])return r[t];var i=r[t]={__name__:t,_dependencies:[],_modules:[],_instance:e,_status:"",_callbacks:pyscript.list(),"import":function(t){return i._dependencies.push({url:t}),i},initialize:function(t){return i._modules.push(t),i},def:function(r){var n=pyscript.map(function(r,n){return pyscript.isFunction(r)?pyscript.partial(r,e):void pyscript.assert(!1,"'"+n+"' cannot be set as a function of '"+t+"'")},r);return pyscript.extend(e,n),i},__init__:function(t){return i._callbacks.push(t),i},__new__:function(t){return t.call(null,e),i},_initialize:function(){function s(){var t=i._dependencies;if(t.length==a)o();else if(a<t.length){var e=t[a].url;void 0!==n[e]?(a++,s()):(n[e]=!1,pyscript["import"]("script",{src:pyscript._getURL(e)},function(){pyscript.debug&&console.log(e,"loaded"),n[e]=!0,a++,s()},!0))}}function o(){if(i._modules.length==p)pyscript.defer(function(){i._status="loaded",i._callbacks.each(function(t){t.call(null,e)}),c.resolve(e),pyscript.debug&&console.log("%c"+t+" loaded","font-weight:bold;"),e.__initialized__=!0});else{var n=i._modules[p];void 0===r[n]?pyscript.assert(!1,"","Module '"+n+"' is not defined!"):pyscript.initialize(n).then(function(){p++,o()})}}var c=pyscript.async();if("loaded"==i._status)return pyscript.defer(function(){c.resolve(e)}),c.promise;if("loading"==i._status)return i._callbacks.push(function(){c.resolve(e)}),c.promise;pyscript.debug&&console.log("%c"+t+" loading...","color:DodgerBlue;"),i._status="loading";var a=0,p=0;return s(),c.promise}};return i},pyscript.debug=!0,pyscript.prefix="",function(t){t.extend(t,{assert:function(t,e,r){if(!t)throw r&&console.log(r),new Error(e)},check:function(e,r){if(r===Object)t.assert(t.isObject(e),"expected Object got "+Object.prototype.toString.call(e),e);else if(r==Array)t.assert(t.isArray(e),"expected Array got "+Object.prototype.toString.call(e),e);else if(r==String)t.assert(t.isString(e),"expected String got "+Object.prototype.toString.call(e),e);else if(r==Boolean)t.assert(t.isBoolean(e),"expected Boolean got "+Object.prototype.toString.call(e),e);else if(r==Number)t.assert(t.isNumber(e),"expected Number got "+Object.prototype.toString.call(e),e);else if(r==Function)t.assert(t.isFunction(e),"expected Function got "+Object.prototype.toString.call(e),e);else if(t.isFunction(r))t.assert(r.call(e,e),"type check function returned false",e);else if(t.isObject(r)){t.check(e,Object);for(var n in r)r.hasOwnProperty(n)&&t.check(e[n],r[n])}},isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},isString:function(t){return"[object String]"===Object.prototype.toString.call(t)},isObject:function(t){return"[object Object]"===Object.prototype.toString.call(t)},isDefined:function(t){return"[object Null]"!==Object.prototype.toString.call(t)&&"[object Undefined]"!==Object.prototype.toString.call(t)},isNumber:function(t){return"[object Number]"===Object.prototype.toString.call(t)},isBoolean:function(t){return"[object Boolean]"===Object.prototype.toString.call(t)},isFunction:function(t){return"[object Function]"===Object.prototype.toString.call(t)}})}(pyscript),function(t){function e(){var t=this;t._callbacks=pyscript.list(),t._binding=null,t.promise={then:function(e){return t._callbacks.push(e),t.promise}}}t.extend(e.prototype,{bind:function(t){return this._binding=t,this},resolve:function(){var t=arguments,e=this;this._callbacks.each(function(r){r.apply(e._binding,t)})}}),t.async=function(){return new e}}(pyscript),function(t){function e(e){pyscript.check(e,{}),t.extend(this,e)}t.extend(e.prototype,{update:function(t){return pyscript.extend(this,t)},keys:function(){var t=[];for(var e in this)this.hasOwnProperty(e)&&t.push(e);return t},values:function(){var t=[];for(var e in this)this.hasOwnProperty(e)&&t.push(this[e]);return t},clear:function(){for(var t in this)this.hasOwnProperty(t)&&delete this[t]},contains:function(t){return this.hasOwnProperty(t)},get:function(t,e){return void 0===this[t]?e:this[t]},find:function(t){for(var e in this)if(this.hasOwnProperty(e)&&this[e]==t)return e}}),t.dict=function(t){return new e(t||{})}}(pyscript),function(t){var e={removeAt:function(t){return t>=0&&t<this.length?this.splice(t,1)[0]:!1},remove:function(t,e){var r=(e||this).indexOf(t);return r>=0?(this.splice(r,1),r):!1},contains:function(t){return-1!=this.indexOf(t)},replace:function(t,e){this[this.indexOf(t)]=e},insertAt:function(t,e){t=t||0,this.splice(t,0,e)},removeWhere:function(t,e){for(var r=0,n=[];r<this.length;)e==this[r][t]?n.push(this.splice(r,1)):r+=1;return n},removeOne:function(t,e){for(var r=0;r<this.length;){if(e==this[r][t])return this.splice(r,1);r+=1}pykit.fail(pykit.replaceString("{key}: {value} cannot be removed in {array}",{key:t,value:e,array:this}))},indexWhere:function(t,e){for(var r=[],n=0;n<this.length;n++)this[n][t]==e&&r.push(n);return r},findWhere:function(t,e){for(var r=[],n=0;n<this.length;n++)this[n][t]==e&&r.push(this[n]);return r},findOne:function(t,e,r){for(var n=0;n<this.length;n++)if(this[n][t]===e)return this[n];r&&pykit.fail(pykit.replaceString("{key}: {value} not found in {array}",{key:t,value:e,array:this}))},copy:function(){return this.slice()},first:function(){return this[0]},last:function(){return this[this.length-1]},until:function(t,e){for(var r,n=this.slice(),i=0;n.length&&(r=n.shift(),t.call(e,r,n)?i=0:(n.push(r),i++),0!=n.length);)if(i>n.length){pykit.fail("Infinite loop detected.");break}},any:function(t,e){for(var r=0;r<this.length;r++)if(t.call(e||this,this[r],r))return!0;return!1},all:function(t,e){for(var r=0;r<this.length;r++)if(!t.call(e||this,this[r],r))return!1;return!0},each:function(t,e){for(var r=[],n=0;n<this.length;n++)r[n]=t.call(e||this,this[n],n);return r},remap:function(t,e){for(var r=0;r<this.length;r++)this[r]=t.call(e||this,this[r])},filter:function(t,e){for(var r=[],n=0;n<this.length;n++)t.call(e||this,this[n])&&r.push(this[n]);return r},insertSorted:function(t,e,r){for(var n,i=this.length-1;i>=0;i--)if(n=e.call(r||this,t,this[i]),n>=0)return this.insertAt(i,t),i;return this.push(t),i}};t.list=function(r){return t.extend(r||[],e)}}(pyscript),function(t){function e(t){this.string=t}t.extend(e.prototype,{contains:function(t){return-1!=this.string.indexOf(t)},ellipsis:function(t){return t=t||18,this.string.length>t?this.string.substr(0,t-3)+"...":this.string},endsWith:function(t){return-1!==this.string.indexOf(t,this.string.length-t.length)},beginsWith:function(t){return 0==this.string.indexOf(t)},replaceLastIndexOf:function(t,e){var r=this.string.lastIndexOf(t);return r>=0?this.string.substring(0,r)+e+this.string.substring(r+t.length):void 0},toCamelCase:function(){return this.string.replace(/(?:^\w|[A-Z]|\b\w|\s+)/g,function(t,e){return 0===+t?"":0==e?t.toLowerCase():t.toUpperCase()})},format:function(t){var e=this.string;for(var r in t)if(t.hasOwnProperty(r)){var n=new RegExp("{"+r+"}","gi");e=e.replace(n,t[r])}return e}}),t.str=function(t){return new e(t||"")}}(pyscript),pyscript.defmodule("cache").__init__(function(t){t.onSyncSuccess=pyscript.noop,t._storage=pyscript.dict()}).def({flush:function(t){t._storage.clear()},cacheFile:function(t,e,r){var n=pyscript.async(),i=new FileReader;return i.onload=function(i){t._storage[e]={localUrl:i.target.result,file:r},n.resolve(e,i.target.result)},i.readAsDataURL(r.file),n.promise},fetchUrl:function(t,e){return t._storage.get(e,{localUrl:e}).localUrl},syncAll:function(t){pyscript.map(t.syncFile,t._storage.keys())},syncFile:function(t,e){var r=t._storage.get(e);if(r){var n=r.file;n&&pyscript.requests.upload(r.url,n.file,n).then(t.onSyncSuccess)}},fetch:function(t,e,r){pyscript.check(e,String);var n=pyscript.async();return t._storage.contains(e)?pyscript.defer(function(){n.resolve({success:!0,cached:!0,url:e,parser:r,result:t.get(e)})}):pyscript.requests.get(e).then(function(){var i={success:!1,url:e,parser:r};if(this.http.success){var s=this.responseText||"";s=r?r(s):s,t._storage[e]=s,i.result=s,i.success=!0}n.resolve(i)}),n.promise},move:function(t,e,r){if(pyscript.check(r,String),pyscript.check(e,String),r!=e){if(!t._storage.contains(e))throw new ReferenceError("Cannot find "+e+" in cache!");t._storage[r]=t._storage[e],delete t._storage[e]}},"delete":function(t,e){pyscript.check(e,String),delete t._storage[e]},contains:function(t,e){return pyscript.check(e,String),t._storage.contains(e)},store:function(t,e,r){t._storage[e]=r},find:function(t,e){return t._storage.find(e)},get:function(t,e,r){return t._storage.get(e,r)},keys:function(t){return t._storage.keys()},values:function(t){return t._storage.values()}}),pyscript.cache=pyscript.module("cache"),pyscript.defmodule("hotkeys").__new__(function(t){t.scope="all",t._keyMap={backspace:8,tab:9,clear:12,enter:13,"return":13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,"delete":46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220},t._downKeys=[],t._modifierMap={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"},t._modifier={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,command:91},t._mods={16:!1,18:!1,17:!1,91:!1},t._handlers={};for(var e=1;20>e;e++)t._keyMap["f"+e]=111+e}).__init__(function(t){document.addEventListener("keydown",t.dispatchKeyEvent),document.addEventListener("keyup",t.clearModifiers)}).def({clearModifiers:function(t,e){var r=e.keyCode,n=t._downKeys.indexOf(r);n>=0&&t._downKeys.splice(n,1),(93===r||224===r)&&(r=91),r in t._mods&&(t._mods[r]=!1)},dispatchKeyEvent:function(t,e){var r=e.keyCode;-1===t._downKeys.indexOf(r)&&t._downKeys.push(r),(93===r||224===r)&&(r=91),r in t._mods&&(t._mods[r]=!0);for(var n in t._mods)t._mods[n]=e[t._modifierMap[n]];if(t.filter.call(this,e)&&r in t._handlers)for(var i,s=t._mods,o=0;o<t._handlers[r].length;o++){i=t._handlers[r][o];var c=i.mods,a=c.length>0;for(var p in s)if(p=parseInt(p),!s[p]&&-1!=c.indexOf(p)||s[p]&&-1==c.indexOf(p)){a=!1;break}(0!==c.length||s[16]||s[18]||s[17]||s[91])&&!a||i.method(e,i)}},getKeys:function(t,e){var r=e.replace(/\s/g,"").split(",");return""===r[r.length-1]&&(r[r.length-2]+=","),r},getMods:function(t,e){for(var r=e.slice(0,e.length-1),n=0;n<r.length;n++)r[n]=t._modifier[r[n].toLowerCase()];return r},addKey:function(t,e,r,n){var i=t.getKeys(e);n||(n=r,r="all");for(var s,o,c=0;c<i.length;c++){o=i[c].split("-"),s=o[o.length-1],s=t._keyMap[s]||s.toUpperCase().charCodeAt(0);var a=[];o.length>1&&(a=t.getMods(o)),s in t._handlers||(t._handlers[s]=[]),t._handlers[s].push({shortcut:i[c],scope:r,method:n,key:i[c],mods:a})}},filter:function(t,e){var r=e.target.tagName;return!("INPUT"===r||"SELECT"===r||"TEXTAREA"===r)}}),pyscript.hotkeys=pyscript.module("hotkeys"),pyscript.defmodule("requests").__init__(function(t){t.interceptors=[],t.parsers={echo:function(t){return t}},t.headers=null,t.routes=pyscript.list(),t._defaultStatusText={200:"OK",201:"Created",202:"Accepted",204:"No Content",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",409:"Conflict",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",511:"Network Authentication Required"}}).def({whenGET:function(t,e,r,n,i){return t._storeRoute("GET",e,r,n,i)},whenPOST:function(t,e,r,n,i){return t._storeRoute("POST",e,r,n,i)},whenPATCH:function(t,e,r,n,i){return t._storeRoute("PATCH",e,r,n,i)},whenPUT:function(t,e,r,n,i){return t._storeRoute("PUT",e,r,n,i)},whenDELETE:function(t,e,r,n,i){return t._storeRoute("DELETE",e,r,n,i)},_storeRoute:function(t,e,r,n,i,s){pyscript.check(n,Function);var o=t.routes.findOne("pattern",r),c={priority:s||1,pattern:new RegExp(r),method:e,callback:n,callThrough:i||!1};return o?pyscript.extend(o,c):t.routes.push(c),t},mockSetup:function(t){pyscript.assert(jasmine,"mockSetup() can only be called in Jasmine testing!"),t.mockServer={routes:{GET:{},POST:{},PATCH:{},DELETE:{},PUT:{},UPLOAD:{}},request:function(e,r,n,i,s){var o=pyscript.async();return pyscript.defer(function(){var c=t.mockServer.routes[e][r];pyscript.isFunction(c)&&o.bind(c.call(null,r,n,i,s)).resolve()}),o.promise},defRoute:function(e,r,n){return pyscript.check(e,String),pyscript.check(n,Function),e=e.toUpperCase(),pyscript.assert(t.mockServer.routes[e],"method must be GET/POST/PATCH/PUT/DELETE."),t.mockServer.routes[e][r]=n,t.mockServer}},spyOn(t,"get").and.callFake(pyscript.partial(t.mockServer.request,"GET")),spyOn(t,"put").and.callFake(pyscript.partial(t.mockServer.request,"PUT")),spyOn(t,"del").and.callFake(pyscript.partial(t.mockServer.request,"DELETE")),spyOn(t,"patch").and.callFake(pyscript.partial(t.mockServer.request,"PATCH")),spyOn(t,"post").and.callFake(pyscript.partial(t.mockServer.request,"POST")),spyOn(t,"upload").and.callFake(pyscript.partial(t.mockServer.request,"UPLOAD"))},get:function(t,e,r,n){return t._send("GET",e,null,r,n)},del:function(t,e,r,n){return t._send("DELETE",e,null,r,n)},patch:function(t,e,r,n,i){return t._send("PATCH",e,r,n,i)},post:function(t,e,r,n,i){return t._send("POST",e,r,n,i)},put:function(t,e,r,n,i){return t._send("PUT",e,r,n,i)},upload:function(t,e,r,n,i){return t._send("POST",e,r,n,i,!0)},_send:function(t,e,r,n,i,s,o){function c(){t._parseStatus(this);var e=t._triggerInterceptors("response",this);e&&a.bind(this).resolve()}pyscript.check(e,String),pyscript.check(e,r);var a=pyscript.async();i=i||{},t.headers&&pyscript.extend(i,t.headers);var p;o?(p=new FormData,p.append("upload",n)):(p=JSON.stringify(n),i["Content-Type"]="application/json");var u=t._triggerInterceptors("request",null,[n,{headers:i,url:r,method:e}]);if(u){var l=t._matchRoute(e,r);if(l&&!l.callThrough){var f=l.callback(p,{headers:i,url:r,method:e})||[];t._resolveProxyResponse(f,a)}if(!l||l.callThrough){var d=new XMLHttpRequest;d.onload=c,d.onerror=c,d.open(e,r,!s);for(var h in i)i.hasOwnProperty(h)&&d.setRequestHeader(h,i[h]);d.send(p)}return s?d:a.promise}},_triggerInterceptors:function(t,e,r,n){for(var i,s,o=0;o<t.interceptors.length;o++)if(s=t.interceptors[o],s[e]&&(i=s[e].apply(r,n),i===!1))return!1;return!0},_matchRoute:function(t,e,r){for(var n,i,s=-1,o=0;o<t.routes.length;o++)i=t.routes[o],i.method==e&&i.pattern.test(r)&&i.priority>s&&(s=i.priority,n=i);return n},_resolveProxyResponse:function(t,e,r){var n={status:e[0],statusText:e[3]||t._defaultStatusText[e[0]],getResponseHeader:function(t){var r=e[2]||{};return r[t]},responseText:pyscript.isString(e[1])?e[1]:JSON.stringify(e[1])};t._parseStatus(n);var i=t._triggerInterceptors("response",n);i&&pyscript.defer(function(){r.bind(n).resolve()})},_parseStatus:function(t,e){var r=e.status;e.http={success:r>=200&&400>r,redirect:r>=300&&400>r,error:r>=400,unavailable:503==r,serverError:r>=500,clientError:r>=400&&500>r,conflict:409==r,created:201==r,unauthorized:401==r,missing:404==r,badRequest:400==r,noContent:204==r,ok:200==r,network:0==r||void 0===r}}}),pyscript.requests=pyscript.module("requests"),pyscript.defmodule("router").__new__(function(t){t.proxy={setHash:function(t){window.location.hash=t},setHref:function(t){window.location.href=t},setPathname:function(t){window.location.pathname=t},getHash:function(){return window.location.hash},getHref:function(){return window.location.href},getPathname:function(){return window.location.pathname}},window.addEventListener("hashchange",function(){t._onchange.call(t)})}).__init__(function(t){t._routes={},t._params={},t._promises=[]}).def({mockSetup:function(t,e){pyscript.assert(jasmine,"mockSetup() can only be called in Jasmine testing."),spyOn(t.proxy,"setHash").and.callFake(function(e){t.proxy.setHref(t.proxy.getHref().split("#")[0]+"#"+e),pyscript.defer(t._onchange)}),spyOn(t.proxy,"getHash").and.callFake(function(){var e=t.proxy.getHref().split("#")[1];return e?"#"+e:""}),spyOn(t.proxy,"setHref").and.callFake(function(r){if(e)throw new Error("Page refresh detected. Redirection to: "+r);t.proxy._href=r}),spyOn(t.proxy,"getHref").and.callFake(function(){return t.proxy._href||window.location.href}),spyOn(t.proxy,"setPathname").and.callFake(function(r){if(e)throw new Error("Page refresh detected. Redirection to: "+r);t.proxy.setHref(t.proxy.getHref().replace(t.proxy.getPathname(),r))}),spyOn(t.proxy,"getPathname").and.callFake(function(){var e=t.proxy.getHref(),r=e.replace("://","").split("/",1)[1]||"";return r=r.split("?")[0].split("#")[0]})},refresh:function(t){pyscript.defer(function(){t._onchange(t)})},route:function(t,e,r){e=pyscript.isString(e)?[e]:e;for(var n,i=0;i<e.length;i++)n=e[i],t._routes[n]=t._routes[n]||[],t._routes[n].push(r);return t},_onchange:function(t){var e=t.proxy.getHash().slice(2).split("?")[0].split("/"),r=t.parseQuery(),n="";pyscript.map(function(i,s){n=n+"/"+i;var o=t._routes[s==e.length-1?n:n+"/*"];if(o&&o.length>0)for(var c=0;c<o.length;c++)o[c].call(t,r)},e);for(var i=0;i<t._promises.length;i++)t._promises[i].resolve();t._promises=[]},parseQuery:function(t){var e=t.proxy.getHash(),r=[];e.indexOf("?")&&(r=e.slice(2).split("?"),r=r[r.length-1].split("&"));var n,i={};return pyscript.map(function(t){n=t.split("="),i[n[0]]=decodeURIComponent(n[1])},r),i},asQueryString:function(t,e){var r="?";for(var n in e)e.hasOwnProperty(n)&&e[n]&&(r+=n+"="+encodeURIComponent(e[n])+"&");return r.substr(0,r.length-1)},go:function(t,e,r){pyscript.check(e,String);var n=pyscript.async();return t._promises.push(n),t.proxy.setHash(e+this.asQueryString(t._params)),r&&t.refresh(),n.promise},query:function(t,e){pyscript.check(e,Object),t._params=e;var r=t.parseQuery();pyscript.extend(r,e),t.proxy.setHref(t.proxy.getHref().split("?")[0]+t.asQueryString(t._params))},redirect:function(t,e){t.proxy.setPathname(e)}}),pyscript.router=pyscript.module("router");